app
.controller('HomeCtrl',
    function ($scope, $element, parallaxHelper, $state) {
    $scope.background = parallaxHelper.createAnimator(-0.3, 150, -150);

    	var altura=0;
    	var limite = 0;
    	var lastScrollTop = 0;
    	var position;		
		var position_c;
		var recalc;
		var recalc_c;
		if($state.current.name==='home'){
	    	$(window).scroll(function(event){
			var st = $(this).scrollTop();

	    		if(limite==1){

	    		 position = $('.backbuildings').css("height");			
	    		 position_c = $('.new-footer').css("height");

		    		if (st > lastScrollTop)
		    		{
		    //			 recalc = parseInt(position.substring(0, position.length - 2), 10) -1;
		    //			 recalc_c = parseInt(position_c.substring(0, position_c.length - 2), 10) -3;
		    //			$('.backbuildings').css("height", recalc + 'px');
		    //			$('.new-footer').css("height", recalc_c + 'px');		
		    		}
		    		else
		    		{
		    //		    recalc = parseInt(position.substring(0, position.length - 2), 10) +1;
		    //			 recalc_c = parseInt(position_c.substring(0, position_c.length - 2), 10) +3;
		    //			$('.backbuildings').css("height", recalc + 'px');
		    //			$('.new-footer').css("height", recalc_c + 'px');	
		    		}
	    		}
	  			lastScrollTop = st;
	    	});

			var parallax = new Waypoint({
			  element: document.getElementById('foot'),
			  handler: function(direction) {
			  		if(limite==0)
			  		{
						//limite=1;
						//altura=$('.navbar-header').offset().top;
						//alert(altura);
			  		}
			  		else
			  		{
			  			//limite=0;
			  		}
			  },
			offset: '380'
			});
	        $scope.myPattern = '<%= image_url 'backbuildings.png' %>';
			var waypoint = new Waypoint({
			  element: document.getElementById('basic-waypoint'),
			  handler: function(direction) {
			  	var myEl = angular.element( document.querySelector( '#menubar-big' ) );

					altura=$("#menubar-big").offset().top;
					if(altura>160)
					{
						myEl.addClass('not-up'); 
					}
					else
					{
						$("#menubar-big").removeClass("not-up");
					}
			/*	if($("#menubar-big").hasClass("not-up")==false)
				{

					myEl.addClass('not-up'); 
				}
				else
				{
					$("#menubar-big").removeClass("not-up");
				}
				*/
			  },
			offset: '380'
			});
		}
		else
		{
			var myEl = angular.element( document.querySelector( '#menubar-big' ) );

			myEl.addClass('not-up'); 	
		}
    }
);
