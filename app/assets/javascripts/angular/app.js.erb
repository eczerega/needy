function hasClass( elem, klass ) {
     return (" " + elem.className + " " ).indexOf( " "+klass+" " ) > -1;
}

var app = angular
    .module('needy',
    [
        'ngMaterial',
        'duParallax'
    ]
)
app
.controller('MainCtrl',
    function ($scope, $element, parallaxHelper) {
    $scope.background = parallaxHelper.createAnimator(-0.3, 150, -150);
    	
    	var altura=0;
    	var limite = 0;
    	var lastScrollTop = 0;
    	var position;		
		var position_c;
		var recalc;
		var recalc_c;
    	$(window).scroll(function(event){
		var st = $(this).scrollTop();

    		if(limite==1){

    		 position = $('.backbuildings').css("height");			
    		 position_c = $('.new-footer').css("height");

	    		if (st > lastScrollTop)
	    		{
	    			 recalc = parseInt(position.substring(0, position.length - 2), 10) -1;
	    			 recalc_c = parseInt(position_c.substring(0, position_c.length - 2), 10) -3;
	    			$('.backbuildings').css("height", recalc + 'px');
	    			$('.new-footer').css("height", recalc_c + 'px');		
	    		}
	    		else
	    		{
	    		    recalc = parseInt(position.substring(0, position.length - 2), 10) +1;
	    			 recalc_c = parseInt(position_c.substring(0, position_c.length - 2), 10) +3;
	    			$('.backbuildings').css("height", recalc + 'px');
	    			$('.new-footer').css("height", recalc_c + 'px');	
	    		}
    		}
  			lastScrollTop = st;
    	});

		var parallax = new Waypoint({
		  element: document.getElementById('foot'),
		  handler: function(direction) {
		  		if(limite==0)
		  		{
					limite=1;
					altura=$('.navbar-header').offset().top;
					//alert(altura);
		  		}
		  		else
		  		{
		  			limite=0;
		  		}
		  },
		offset: '380'
		});


		/*var lastScrollTop = 0;
		$(window).scroll(function(event){
		   var st = $(this).scrollTop();
		   //var position = $('.backbuildings').css("bottom");
		   var position = $('.new-footer').css("height");
		   var position_b = $('.backbuildings').css("height");
		   //alert(position);
		   if (st > lastScrollTop){
			var parallax = new Waypoint({
			  element: document.getElementById('foot'),
			  handler: function(direction) {
			  	var buildings = angular.element( document.querySelector( '.new-footer' ) );
			  	var recalc = parseInt(position.substring(0, position.length - 2), 10) -3;
			  	var recalc_b = parseInt(position_b.substring(0, position_b.length - 2), 10) -1;
			  	$('.new-footer').css('height', recalc + 'px');
			  	$('.backbuildings').css('height', recalc_b + 'px');
			  },
			offset: '280'
			});
		   } 
		   else 
		   {
			var parallax = new Waypoint({
			  element: document.getElementById('foot'),
			  handler: function(direction) {
			  	var buildings = angular.element( document.querySelector( '.new-footer' ) );
			  	var recalc = parseInt(position.substring(0, position.length - 2), 10) +3;
			  	var recalc_b = parseInt(position_b.substring(0, position_b.length - 2), 10) +1;
			  	$('.new-footer').css('height', recalc + 'px');
			  	$('.backbuildings').css('height', recalc_b + 'px');
			  },
			offset: '280'
			});
		   }
		   lastScrollTop = st;
		});
		*/
        $scope.test= 'Hola soy needy!';
        $scope.myPattern = '<%= image_url 'backbuildings.png' %>';
		var waypoint = new Waypoint({
		  element: document.getElementById('basic-waypoint'),
		  handler: function(direction) {
		  	var myEl = angular.element( document.querySelector( '#menubar-big' ) );

			if($("#menubar-big").hasClass("not-up")==false)
			{
				myEl.addClass('not-up'); 
			}
			else
			{
				$("#menubar-big").removeClass("not-up");
			}
		  },
		offset: '380'
		});
    }
);
